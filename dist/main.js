/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";let t=()=>{};let i,e,s={};function h(t,i){s[t]=s[t]||[],s[t].push(i)}function n(t,...i){(s[t]||[]).map((t=>t(...i)))}let r={get:(i,e)=>"_proxy"==e||t};function a(){return e}function o(t,i,e){return Math.min(Math.max(t,e),i)}class c{constructor(t=0,i=0,e={}){null!=t.x?(this.x=t.x,this.y=t.y):(this.x=t,this.y=i),e._c&&(this.clamp(e._a,e._b,e._d,e._e),this.x=t,this.y=i)}set(t){this.x=t.x,this.y=t.y}add(t){return new c(this.x+t.x,this.y+t.y,this)}subtract(t){return new c(this.x-t.x,this.y-t.y,this)}scale(t){return new c(this.x*t,this.y*t)}normalize(t=this.length()||1){return new c(this.x/t,this.y/t)}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.hypot(this.x,this.y)}distance(t){return Math.hypot(this.x-t.x,this.y-t.y)}angle(t){return Math.acos(this.dot(t)/(this.length()*t.length()))}direction(){return Math.atan2(this.y,this.x)}clamp(t,i,e,s){this._c=!0,this._a=t,this._b=i,this._d=e,this._e=s}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?o(this._a,this._d,t):t}set y(t){this._y=this._c?o(this._b,this._e,t):t}}function d(){return new c(...arguments)}class l{constructor(t){return this.init(t)}init(t={}){this.position=d(),this.velocity=d(),this.acceleration=d(),this.ttl=1/0,Object.assign(this,t)}update(t){this.advance(t)}advance(t){let i=this.acceleration;t&&(i=i.scale(t)),this.velocity=this.velocity.add(i);let e=this.velocity;t&&(e=e.scale(t)),this.position=this.position.add(e),this._pc(),this.ttl--}get dx(){return this.velocity.x}get dy(){return this.velocity.y}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}isAlive(){return this.ttl>0}_pc(){}}class u extends l{init({width:t=0,height:i=0,context:e=a(),render:s=this.draw,update:n=this.advance,children:r=[],anchor:o={x:0,y:0},opacity:c=1,rotation:d=0,scaleX:l=1,scaleY:u=1,...w}={}){this._c=[],super.init({width:t,height:i,context:e,anchor:o,opacity:c,rotation:d,scaleX:l,scaleY:u,...w}),this._di=!0,this._uw(),this.addChild(r),this._rf=s,this._uf=n,h("init",(()=>{this.context??=a()}))}update(t){this._uf(t),this.children.map((i=>i.update&&i.update(t)))}render(){let t=this.context;t.save(),(this.x||this.y)&&t.translate(this.x,this.y),this.rotation&&t.rotate(this.rotation),1==this.scaleX&&1==this.scaleY||t.scale(this.scaleX,this.scaleY);let i=-this.width*this.anchor.x,e=-this.height*this.anchor.y;(i||e)&&t.translate(i,e),this.context.globalAlpha=this.opacity,this._rf(),(i||e)&&t.translate(-i,-e),this.children.map((t=>t.render&&t.render())),t.restore()}draw(){}_pc(){this._uw(),this.children.map((t=>t._pc()))}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this._pc()}set y(t){this.position.y=t,this._pc()}get width(){return this._w}set width(t){this._w=t,this._pc()}get height(){return this._h}set height(t){this._h=t,this._pc()}_uw(){if(!this._di)return;let{_wx:t=0,_wy:i=0,_wo:e=1,_wr:s=0,_wsx:h=1,_wsy:n=1}=this.parent||{};this._wx=this.x,this._wy=this.y,this._ww=this.width,this._wh=this.height,this._wo=e*this.opacity,this._wsx=h*this.scaleX,this._wsy=n*this.scaleY,this._wx=this._wx*h,this._wy=this._wy*n,this._ww=this.width*this._wsx,this._wh=this.height*this._wsy,this._wr=s+this.rotation;let{x:r,y:a}=function(t,i){let e=Math.sin(i),s=Math.cos(i);return{x:t.x*s-t.y*e,y:t.x*e+t.y*s}}({x:this._wx,y:this._wy},s);this._wx=r,this._wy=a,this._wx+=t,this._wy+=i}get world(){return{x:this._wx,y:this._wy,width:this._ww,height:this._wh,opacity:this._wo,rotation:this._wr,scaleX:this._wsx,scaleY:this._wsy}}set children(t){this.removeChild(this._c),this.addChild(t)}get children(){return this._c}addChild(...i){i.flat().map((i=>{this.children.push(i),i.parent=this,i._pc=i._pc||t,i._pc()}))}removeChild(...t){t.flat().map((t=>{(function(t,i){let e=t.indexOf(i);if(-1!=e)return t.splice(e,1),!0})(this.children,t)&&(t.parent=null,t._pc())}))}get opacity(){return this._opa}set opacity(t){this._opa=o(0,1,t),this._pc()}get rotation(){return this._rot}set rotation(t){this._rot=t,this._pc()}setScale(t,i=t){this.scaleX=t,this.scaleY=i}get scaleX(){return this._scx}set scaleX(t){this._scx=t,this._pc()}get scaleY(){return this._scy}set scaleY(t){this._scy=t,this._pc()}}class w extends u{init({image:t,width:i=(t?t.width:void 0),height:e=(t?t.height:void 0),...s}={}){super.init({image:t,width:i,height:e,...s})}get animations(){return this._a}set animations(t){let i,e;for(i in this._a={},t)this._a[i]=t[i].clone(),e=e||this._a[i];this.currentAnimation=e,this.width=this.width||e.width,this.height=this.height||e.height}playAnimation(t){this.currentAnimation?.stop(),this.currentAnimation=this.animations[t],this.currentAnimation.start()}advance(t){super.advance(t),this.currentAnimation?.update(t)}draw(){this.image&&this.context.drawImage(this.image,0,0,this.image.width,this.image.height),this.currentAnimation&&this.currentAnimation.render({x:0,y:0,width:this.width,height:this.height,context:this.context}),this.color&&(this.context.fillStyle=this.color,this.context.fillRect(0,0,this.width,this.height))}}function _(t){let i=t.canvas;t.clearRect(0,0,i.width,i.height)}new WeakMap;let x={},p={},y={},g={Enter:"enter",Escape:"esc",Space:"space",ArrowLeft:"arrowleft",ArrowUp:"arrowup",ArrowRight:"arrowright",ArrowDown:"arrowdown"};function m(i=t,e){i._pd&&e.preventDefault(),i(e)}function f(t){let i=g[t.code],e=x[i];y[i]=!0,m(e,t)}function v(t){let i=g[t.code],e=p[i];y[i]=!1,m(e,t)}function A(){y={}}!function(){let t;for(t=0;t<26;t++)g["Key"+String.fromCharCode(t+65)]=String.fromCharCode(t+97);for(t=0;t<10;t++)g["Digit"+t]=g["Numpad"+t]=""+t;window.addEventListener("keydown",f),window.addEventListener("keyup",v),window.addEventListener("blur",A)}();let{canvas:C}=function(t,{contextless:s=!1}={}){if(i=document.getElementById(t)||t||document.querySelector("canvas"),s&&(i=i||new Proxy({},r)),!i)throw Error("You must provide a canvas element for the game");return e=i.getContext("2d")||new Proxy({},r),e.imageSmoothingEnabled=!1,n("init"),{canvas:i,context:e}}(),E=function(){return new w(...arguments)}({x:100,y:80,color:"green",width:20,height:20,dx:2});(function({fps:i=60,clearCanvas:e=!0,update:s=t,render:r,context:o=a(),blur:c=!1}={}){if(!r)throw Error("You must provide a render() function");let d,l,u,w,x,p=0,y=1e3/i,g=1/i,m=e?_:t,f=!0;function v(){if(l=requestAnimationFrame(v),f&&(u=performance.now(),w=u-d,d=u,!(w>1e3))){for(n("tick"),p+=w;p>=y;)x.update(g),p-=y;m(x.context),x.render()}}return c||(window.addEventListener("focus",(()=>{f=!0})),window.addEventListener("blur",(()=>{f=!1}))),h("init",(()=>{x.context??=a()})),x={update:s,render:r,isStopped:!0,context:o,start(){d=performance.now(),this.isStopped=!1,requestAnimationFrame(v)},stop(){this.isStopped=!0,cancelAnimationFrame(l)},_frame:v,set _last(t){d=t}},x})({update:function(){E.update(),E.x>C.width&&(E.x=-E.width)},render:function(){E.render()}}).start()})();