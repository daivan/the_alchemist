/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";let t=()=>{};let e,i,h={};function s(t,e){h[t]=h[t]||[],h[t].push(e)}function n(t,...e){(h[t]||[]).map((t=>t(...e)))}let o={get:(e,i)=>"_proxy"==i||t};function r(){return e}function a(){return i}function c(t,e,i){return Math.min(Math.max(t,i),e)}class l{constructor(t=0,e=0,i={}){null!=t.x?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e),i._c&&(this.clamp(i._a,i._b,i._d,i._e),this.x=t,this.y=e)}set(t){this.x=t.x,this.y=t.y}add(t){return new l(this.x+t.x,this.y+t.y,this)}subtract(t){return new l(this.x-t.x,this.y-t.y,this)}scale(t){return new l(this.x*t,this.y*t)}normalize(t=this.length()||1){return new l(this.x/t,this.y/t)}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.hypot(this.x,this.y)}distance(t){return Math.hypot(this.x-t.x,this.y-t.y)}angle(t){return Math.acos(this.dot(t)/(this.length()*t.length()))}direction(){return Math.atan2(this.y,this.x)}clamp(t,e,i,h){this._c=!0,this._a=t,this._b=e,this._d=i,this._e=h}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?c(this._a,this._d,t):t}set y(t){this._y=this._c?c(this._b,this._e,t):t}}function d(){return new l(...arguments)}class u{constructor(t){return this.init(t)}init(t={}){this.position=d(),this.velocity=d(),this.acceleration=d(),this.ttl=1/0,Object.assign(this,t)}update(t){this.advance(t)}advance(t){let e=this.acceleration;t&&(e=e.scale(t)),this.velocity=this.velocity.add(e);let i=this.velocity;t&&(i=i.scale(t)),this.position=this.position.add(i),this._pc(),this.ttl--}get dx(){return this.velocity.x}get dy(){return this.velocity.y}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}isAlive(){return this.ttl>0}_pc(){}}class p extends u{init({width:t=0,height:e=0,context:i=a(),render:h=this.draw,update:n=this.advance,children:o=[],anchor:r={x:0,y:0},opacity:c=1,rotation:l=0,scaleX:d=1,scaleY:u=1,...p}={}){this._c=[],super.init({width:t,height:e,context:i,anchor:r,opacity:c,rotation:l,scaleX:d,scaleY:u,...p}),this._di=!0,this._uw(),this.addChild(o),this._rf=h,this._uf=n,s("init",(()=>{this.context??=a()}))}update(t){this._uf(t),this.children.map((e=>e.update&&e.update(t)))}render(){let t=this.context;t.save(),(this.x||this.y)&&t.translate(this.x,this.y),this.rotation&&t.rotate(this.rotation),1==this.scaleX&&1==this.scaleY||t.scale(this.scaleX,this.scaleY);let e=-this.width*this.anchor.x,i=-this.height*this.anchor.y;(e||i)&&t.translate(e,i),this.context.globalAlpha=this.opacity,this._rf(),(e||i)&&t.translate(-e,-i),this.children.map((t=>t.render&&t.render())),t.restore()}draw(){}_pc(){this._uw(),this.children.map((t=>t._pc()))}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this._pc()}set y(t){this.position.y=t,this._pc()}get width(){return this._w}set width(t){this._w=t,this._pc()}get height(){return this._h}set height(t){this._h=t,this._pc()}_uw(){if(!this._di)return;let{_wx:t=0,_wy:e=0,_wo:i=1,_wr:h=0,_wsx:s=1,_wsy:n=1}=this.parent||{};this._wx=this.x,this._wy=this.y,this._ww=this.width,this._wh=this.height,this._wo=i*this.opacity,this._wsx=s*this.scaleX,this._wsy=n*this.scaleY,this._wx=this._wx*s,this._wy=this._wy*n,this._ww=this.width*this._wsx,this._wh=this.height*this._wsy,this._wr=h+this.rotation;let{x:o,y:r}=function(t,e){let i=Math.sin(e),h=Math.cos(e);return{x:t.x*h-t.y*i,y:t.x*i+t.y*h}}({x:this._wx,y:this._wy},h);this._wx=o,this._wy=r,this._wx+=t,this._wy+=e}get world(){return{x:this._wx,y:this._wy,width:this._ww,height:this._wh,opacity:this._wo,rotation:this._wr,scaleX:this._wsx,scaleY:this._wsy}}set children(t){this.removeChild(this._c),this.addChild(t)}get children(){return this._c}addChild(...e){e.flat().map((e=>{this.children.push(e),e.parent=this,e._pc=e._pc||t,e._pc()}))}removeChild(...t){t.flat().map((t=>{(function(t,e){let i=t.indexOf(e);if(-1!=i)return t.splice(i,1),!0})(this.children,t)&&(t.parent=null,t._pc())}))}get opacity(){return this._opa}set opacity(t){this._opa=c(0,1,t),this._pc()}get rotation(){return this._rot}set rotation(t){this._rot=t,this._pc()}setScale(t,e=t){this.scaleX=t,this.scaleY=e}get scaleX(){return this._scx}set scaleX(t){this._scx=t,this._pc()}get scaleY(){return this._scy}set scaleY(t){this._scy=t,this._pc()}}class _ extends p{init({image:t,width:e=(t?t.width:void 0),height:i=(t?t.height:void 0),...h}={}){super.init({image:t,width:e,height:i,...h})}get animations(){return this._a}set animations(t){let e,i;for(e in this._a={},t)this._a[e]=t[e].clone(),i=i||this._a[e];this.currentAnimation=i,this.width=this.width||i.width,this.height=this.height||i.height}playAnimation(t){this.currentAnimation?.stop(),this.currentAnimation=this.animations[t],this.currentAnimation.start()}advance(t){super.advance(t),this.currentAnimation?.update(t)}draw(){this.image&&this.context.drawImage(this.image,0,0,this.image.width,this.image.height),this.currentAnimation&&this.currentAnimation.render({x:0,y:0,width:this.width,height:this.height,context:this.context}),this.color&&(this.context.fillStyle=this.color,this.context.fillRect(0,0,this.width,this.height))}}function w(){return new _(...arguments)}let f=new WeakMap,x={},g={},y={0:"left",1:"middle",2:"right"};function m(t,e){let{x:i,y:h,width:s,height:n}=function(t){let{x:e=0,y:i=0,width:h,height:s}=t.world||t;return t.mapwidth&&(h=t.mapwidth,s=t.mapheight),t.anchor&&(e-=h*t.anchor.x,i-=s*t.anchor.y),h<0&&(e+=h,h*=-1),s<0&&(i+=s,s*=-1),{x:e,y:i,width:h,height:s}}(t);do{i-=t.sx||0,h-=t.sy||0}while(t=t.parent);let o=e.x-Math.max(i,Math.min(e.x,i+s)),r=e.y-Math.max(h,Math.min(e.y,h+n));return o*o+r*r<e.radius*e.radius}function v(t,e){return parseFloat(t.getPropertyValue(e))||0}function b(t){let e=null!=t.button?y[t.button]:"left";g[e]=!0,O(t,"onDown")}function Y(t){let e=null!=t.button?y[t.button]:"left";g[e]=!1,O(t,"onUp")}function E(t){O(t,"onOver")}function X(t){f.get(t.target)._oo=null,g={}}function A(t,e,i){let h=function(t){let e=t._lf.length?t._lf:t._cf;for(let i=e.length-1;i>=0;i--){let h=e[i];if(h.collidesWithPointer?h.collidesWithPointer(t):m(h,t))return h}}(t);h&&h[e]&&h[e](i),x[e]&&x[e](i,h),"onOver"==e&&(h!=t._oo&&t._oo&&t._oo.onOut&&t._oo.onOut(i),t._oo=h)}function O(t,e){t.preventDefault();let i=t.target,h=f.get(i),{scaleX:s,scaleY:o,offsetX:r,offsetY:a}=function(t){let{canvas:e,_s:i}=t,h=e.getBoundingClientRect(),s="none"!=i.transform?i.transform.replace("matrix(","").split(","):[1,1,1,1],n=parseFloat(s[0]),o=parseFloat(s[3]),r=(v(i,"border-left-width")+v(i,"border-right-width"))*n,a=(v(i,"border-top-width")+v(i,"border-bottom-width"))*o,c=(v(i,"padding-left")+v(i,"padding-right"))*n,l=(v(i,"padding-top")+v(i,"padding-bottom"))*o;return{scaleX:(h.width-r-c)/e.width,scaleY:(h.height-a-l)/e.height,offsetX:h.left+(v(i,"border-left-width")+v(i,"padding-left"))*n,offsetY:h.top+(v(i,"border-top-width")+v(i,"padding-top"))*o}}(h);t.type.includes("touch")?(Array.from(t.touches).map((({clientX:t,clientY:e,identifier:i})=>{let n=h.touches[i];n||(n=h.touches[i]={start:{x:(t-r)/s,y:(e-a)/o}},h.touches.length++),n.changed=!1})),Array.from(t.changedTouches).map((({clientX:i,clientY:c,identifier:l})=>{let d=h.touches[l];d.changed=!0,d.x=h.x=(i-r)/s,d.y=h.y=(c-a)/o,A(h,e,t),n("touchChanged",t,h.touches),"onUp"==e&&(delete h.touches[l],h.touches.length--,h.touches.length||n("touchEnd"))}))):(h.x=(t.clientX-r)/s,h.y=(t.clientY-a)/o,A(h,e,t))}function M(...t){t.flat().map((t=>{let e=t.context?t.context.canvas:r(),i=f.get(e);if(!i)throw new ReferenceError("Pointer events not initialized for the objects canvas");t._r||(t._r=t.render,t.render=function(){i._cf.push(this),this._r()},i._o.push(t))}))}function C(t){let e=t.canvas;t.clearRect(0,0,e.width,e.height)}let{canvas:L}=function(t,{contextless:h=!1}={}){if(e=document.getElementById(t)||t||document.querySelector("canvas"),h&&(e=e||new Proxy({},o)),!e)throw Error("You must provide a canvas element for the game");return i=e.getContext("2d")||new Proxy({},o),i.imageSmoothingEnabled=!1,n("init"),{canvas:e,context:i}}();!function({radius:t=5,canvas:e=r()}={}){let i=f.get(e);if(!i){let h=window.getComputedStyle(e);i={x:0,y:0,radius:t,touches:{length:0},canvas:e,_cf:[],_lf:[],_o:[],_oo:null,_s:h},f.set(e,i)}e.addEventListener("mousedown",b),e.addEventListener("touchstart",b),e.addEventListener("mouseup",Y),e.addEventListener("touchend",Y),e.addEventListener("touchcancel",Y),e.addEventListener("blur",X),e.addEventListener("mousemove",E),e.addEventListener("touchmove",E),i._t||(i._t=!0,s("tick",(()=>{i._lf.length=0,i._cf.map((t=>{i._lf.push(t)})),i._cf.length=0})))}();var S=0;let F=w({x:28,y:28,color:"blue",width:100,height:100,onOver:function(){0===S&&(this.color="purple")},onOut:function(){0===S&&(S=1),console.log("moving out of left upper",S),this.color="blue"}}),P=w({x:128,y:28,color:"blue",width:100,height:100,onOver:function(){1===S&&(this.color="purple")},onOut:function(){1===S&&(S=2),console.log("moving out of left upper",S),this.color="blue"}}),R=w({x:128,y:128,color:"blue",width:100,height:100,onOver:function(){2===S&&(this.color="purple")},onOut:function(){2===S&&(S=3),console.log("moving out of left upper",S),this.color="blue"}}),k=w({x:28,y:128,color:"blue",width:100,height:100,onOver:function(){this.color=3===S?"purple":"blue"},onOut:function(){3===S&&(S=0),console.log("moving out of left upper",S),this.color="blue"}});M(F),M(P),M(k),M(R),function({fps:e=60,clearCanvas:i=!0,update:h=t,render:o,context:r=a(),blur:c=!1}={}){if(!o)throw Error("You must provide a render() function");let l,d,u,p,_,w=0,f=1e3/e,x=1/e,g=i?C:t,y=!0;function m(){if(d=requestAnimationFrame(m),y&&(u=performance.now(),p=u-l,l=u,!(p>1e3))){for(n("tick"),w+=p;w>=f;)_.update(x),w-=f;g(_.context),_.render()}}return c||(window.addEventListener("focus",(()=>{y=!0})),window.addEventListener("blur",(()=>{y=!1}))),s("init",(()=>{_.context??=a()})),_={update:h,render:o,isStopped:!0,context:r,start(){l=performance.now(),this.isStopped=!1,requestAnimationFrame(m)},stop(){this.isStopped=!0,cancelAnimationFrame(d)},_frame:m,set _last(t){l=t}},_}({update:function(){F.update(),P.update(),k.update(),R.update()},render:function(){F.render(),P.render(),k.render(),R.render()}}).start()})();